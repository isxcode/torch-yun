---
title: "集群部署"
---

#### 问题1: 本地升级Python3.9版本

```bash
sudo yum groupinstall "Development Tools" -y
sudo yum install gcc libffi-devel bzip2 bzip2-devel zlib-devel xz-devel wget make -y
cd /tmp
sudo wget https://zhishuyun-demo.isxcode.com/tools/open/file/Python-3.9.0.tgz
sudo tar xvf Python-3.9.0.tgz
cd Python-3.9.0
sudo ./configure --enable-optimizations
sudo make altinstall
sudo alternatives --install /usr/bin/python3 python3 /usr/local/bin/python3.9 2
sudo alternatives --config python3
python3 --version
pip3 --version
```

#### 问题2: 内网Python依赖下载太慢

> 指向国内镜像仓库

```bash
pip3 install torch 'transformers[torch]' fastapi uvicorn -i https://mirrors.aliyun.com/pypi/simple/
```

#### 问题3: 当前Python环境中未安装transformers依赖, 请运行 pip3 install 'transformers[torch]' 安装

```bash
python3 -c "import transformers"
```

```log 
Error importing huggingface_hub.hf_api: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'OpenSSL 1.0.2k-fips  26 Jan 2017'. See: https://github.com/urllib3/urllib3/issues/2168
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/home/dehoop/.local/lib/python3.9/site-packages/transformers/__init__.py", line 27, in <module>
    from . import dependency_versions_check
  File "/home/dehoop/.local/lib/python3.9/site-packages/transformers/dependency_versions_check.py", line 16, in <module>
    from .utils.versions import require_version, require_version_core
  File "/home/dehoop/.local/lib/python3.9/site-packages/transformers/utils/__init__.py", line 19, in <module>
    from huggingface_hub import get_full_repo_name  # for backward compatibility
  File "/home/dehoop/.local/lib/python3.9/site-packages/huggingface_hub/__init__.py", line 1028, in __getattr__
    submod = importlib.import_module(submod_path)
  File "/usr/local/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/dehoop/.local/lib/python3.9/site-packages/huggingface_hub/hf_api.py", line 51, in <module>
    import requests
  File "/home/dehoop/.local/lib/python3.9/site-packages/requests/__init__.py", line 43, in <module>
    import urllib3
  File "/home/dehoop/.local/lib/python3.9/site-packages/urllib3/__init__.py", line 42, in <module>
    raise ImportError(
ImportError: urllib3 v2 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'OpenSSL 1.0.2k-fips  26 Jan 2017'. See: https://github.com/urllib3/urllib3/issues/2168
```

##### 解决方案

> 指定urllib3版本

```bash
pip3 install "urllib3==1.26.15" -i https://mirrors.aliyun.com/pypi/simple/
```

#### 问题4: 未检测到uvicorn命令, 请运行 pip3 install uvicorn安装

```log
本地有uvicorn命令，但是系统无法识别
```

##### 解决方案

```bash
command -v uvicorn
# /home/dehoop/.local/bin/uvicorn
```

```bash
vim .bashrc

# 添加环境变量
export PATH="$HOME/.local/bin:$PATH"
```